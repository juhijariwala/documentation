<!DOCTYPE HTML><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Go Server | Go Developer Documentation</title><meta content="text/html; charset=utf-8" http-equiv="Content-Type"><meta name="description" content=""><meta name="generator" content="GitBook 2.2.0"><meta name="HandheldFriendly" content="true"/><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png"><link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon"><link rel="stylesheet" href="../gitbook/style.css"><link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-anchors/plugin.css"><link rel="next" href="../4/4.3.html"/><link rel="prev" href="../4/4.1.html"/></head><body><div class="book" data-level="4.2" data-basepath=".." data-revision="Tue Feb 16 2016 22:28:26 GMT+0530 (IST)"><div class="book-summary"><div class="book-search"><input placeholder="Type to search" class="form-control"/></div><ul class="summary"><li><a href="http://www.go.cd" target="blank" class="custom-link">Home</a></li><li><a href="https://github.com/gocd/documentation/" target="blank" class="custom-link">Contribute</a></li><li class="divider"></li><li class="chapter" data-level="0" data-path="index.html"><a href="../index.html"><i class="fa fa-check"></i> Introduction</a></li><li class="chapter" data-level="1" data-path="1/1.1.html"><a href="../1/1.1.html"><i class="fa fa-check"></i> <b>1.</b> Concepts in Go</a><ul class="articles"><li class="chapter" data-level="1.1" data-path="1/1.1.html"><a href="../1/1.1.html"><i class="fa fa-check"></i> <b>1.1.</b> Domain</a></li><li class="chapter" data-level="1.2"><span><b>1.2.</b> Implementation</span></li></ul></li><li class="chapter" data-level="2" data-path="2/2.1.html"><a href="../2/2.1.html"><i class="fa fa-check"></i> <b>2.</b> Getting Started</a><ul class="articles"><li class="chapter" data-level="2.1" data-path="2/2.1.html"><a href="../2/2.1.html"><i class="fa fa-check"></i> <b>2.1.</b> Setting up your development environment</a></li><li class="chapter" data-level="2.2" data-path="2/2.2.html"><a href="../2/2.2.html"><i class="fa fa-check"></i> <b>2.2.</b> How to go about making changes to the codebase</a></li><li class="chapter" data-level="2.3" data-path="2/2.3.html"><a href="../2/2.3.html"><i class="fa fa-check"></i> <b>2.3.</b> How to add a configuration migration</a></li><li class="chapter" data-level="2.4" data-path="2/2.4.html"><a href="../2/2.4.html"><i class="fa fa-check"></i> <b>2.4.</b> How to add a database migration</a></li></ul></li><li class="chapter" data-level="3" data-path="3/3.1.html"><a href="../3/3.1.html"><i class="fa fa-check"></i> <b>3.</b> Technology Stack</a><ul class="articles"><li class="chapter" data-level="3.1" data-path="3/3.1.html"><a href="../3/3.1.html"><i class="fa fa-check"></i> <b>3.1.</b> Plugins Architecture - OSGi</a></li><li class="chapter" data-level="3.2" data-path="3/3.2.html"><a href="../3/3.2.html"><i class="fa fa-check"></i> <b>3.2.</b> Object Relation Mapping (ORM) - Hibernate &amp; IBatis</a></li><li class="chapter" data-level="3.3"><span><b>3.3.</b> Caching - EhCache</span></li><li class="chapter" data-level="3.4" data-path="3/3.4.html"><a href="../3/3.4.html"><i class="fa fa-check"></i> <b>3.4.</b> Dependency Injection (DI) - Spring</a></li><li class="chapter" data-level="3.5"><span><b>3.5.</b> Model View Controller (MVC)</span><ul class="articles"><li class="chapter" data-level="3.5.1"><span><b>3.5.1.</b> Models - Java</span></li><li class="chapter" data-level="3.5.2"><span><b>3.5.2.</b> Controllers - Servlets &amp; Rails</span></li><li class="chapter" data-level="3.5.3"><span><b>3.5.3.</b> Views - Rails &amp; Velocity</span></li></ul></li><li class="chapter" data-level="3.6" data-path="3/3.6.html"><a href="../3/3.6.html"><i class="fa fa-check"></i> <b>3.6.</b> User Interface (UI) - jQuery &amp; Prototype, SCSS, HTML</a></li><li class="chapter" data-level="3.7"><span><b>3.7.</b> Build Tool - Buildr</span></li></ul></li><li class="chapter" data-level="4" data-path="4/4.1.html"><a href="../4/4.1.html"><i class="fa fa-check"></i> <b>4.</b> Architecture of Go</a><ul class="articles"><li class="chapter" data-level="4.1" data-path="4/4.1.html"><a href="../4/4.1.html"><i class="fa fa-check"></i> <b>4.1.</b> Overview</a></li><li class="chapter active" data-level="4.2" data-path="4/4.2.html"><a href="../4/4.2.html"><i class="fa fa-check"></i> <b>4.2.</b> Go Server</a><ul class="articles"><li class="chapter" data-level="4.2.1" data-path="4/4.2.html"><span><b>4.2.1.</b> Configuration Management</span><ul class="articles"><li class="chapter" data-level="4.2.1.1" data-path="4/4.2.html"><span><b>4.2.1.1.</b> XSD &amp; XML</span></li><li class="chapter" data-level="4.2.1.2" data-path="4/4.2.html"><span><b>4.2.1.2.</b> Schema Migration</span></li><li class="chapter" data-level="4.2.1.3" data-path="4/4.2.html"><span><b>4.2.1.3.</b> Config Repository</span></li><li class="chapter" data-level="4.2.1.4" data-path="4/4.2.html"><span><b>4.2.1.4.</b> Config Merge</span></li><li class="chapter" data-level="4.2.1.5" data-path="4/4.2.html"><span><b>4.2.1.5.</b> Config Diff</span></li></ul></li><li class="chapter" data-level="4.2.2" data-path="4/4.2.html"><span><b>4.2.2.</b> Database Management</span><ul class="articles"><li class="chapter" data-level="4.2.2.1" data-path="4/4.2.html"><span><b>4.2.2.1.</b> Schema</span></li><li class="chapter" data-level="4.2.2.2" data-path="4/4.2.html"><span><b>4.2.2.2.</b> Migration - DBDeploy</span></li><li class="chapter" data-level="4.2.2.3" data-path="4/4.2.html"><span><b>4.2.2.3.</b> Backup</span></li></ul></li><li class="chapter" data-level="4.2.3" data-path="4/4.2.html"><span><b>4.2.3.</b> Material Update Sub System</span><ul class="articles"><li class="chapter" data-level="4.2.3.1" data-path="4/4.2.html"><span><b>4.2.3.1.</b> Material Fingerprint &amp; Flyweights</span></li><li class="chapter" data-level="4.2.3.2" data-path="4/4.2.html"><span><b>4.2.3.2.</b> Supported Materials</span></li></ul></li><li class="chapter" data-level="4.2.4" data-path="4/4.2.html"><span><b>4.2.4.</b> Build Cause Production</span></li><li class="chapter" data-level="4.2.5" data-path="4/4.2.html"><span><b>4.2.5.</b> Pipeline Scheduling</span></li><li class="chapter" data-level="4.2.6" data-path="4/4.2.html"><span><b>4.2.6.</b> Work Assignment</span><ul class="articles"><li class="chapter" data-level="4.2.6.1" data-path="4/4.2.html"><span><b>4.2.6.1.</b> Resource &amp; Environment Mapping</span></li></ul></li><li class="chapter" data-level="4.2.7" data-path="4/4.2.html"><span><b>4.2.7.</b> Artifact Management</span></li><li class="chapter" data-level="4.2.8" data-path="4/4.2.html"><span><b>4.2.8.</b> User Management</span><ul class="articles"><li class="chapter" data-level="4.2.8.1" data-path="4/4.2.html"><span><b>4.2.8.1.</b> Authentication Management</span></li><li class="chapter" data-level="4.2.8.2" data-path="4/4.2.html"><span><b>4.2.8.2.</b> Enable, disable &amp; delete users</span></li><li class="chapter" data-level="4.2.8.3" data-path="4/4.2.html"><span><b>4.2.8.3.</b> User Role Management</span></li></ul></li><li class="chapter" data-level="4.2.9" data-path="4/4.2.html"><span><b>4.2.9.</b> Agent Management</span></li><li class="chapter" data-level="4.2.10" data-path="4/4.2.html"><span><b>4.2.10.</b> UI Architecture</span><ul class="articles"><li class="chapter" data-level="4.2.10.1" data-path="4/4.2.html"><span><b>4.2.10.1.</b> Markup : HTML</span></li><li class="chapter" data-level="4.2.10.2" data-path="4/4.2.html"><span><b>4.2.10.2.</b> Styling: CSS, SASS</span></li><li class="chapter" data-level="4.2.10.3" data-path="4/4.2.html"><span><b>4.2.10.3.</b> Scripting : JavaScript, jQuery and Prototype</span></li></ul></li><li class="chapter" data-level="4.2.11" data-path="4/4.2.html"><span><b>4.2.11.</b> APIs, CCTray &amp; Feeds</span></li></ul></li><li class="chapter" data-level="4.3" data-path="4/4.3.html"><a href="../4/4.3.html"><i class="fa fa-check"></i> <b>4.3.</b> Go Agent</a><ul class="articles"><li class="chapter" data-level="4.3.1" data-path="4/4.3.html"><span><b>4.3.1.</b> Overview</span></li><li class="chapter" data-level="4.3.2" data-path="4/4.3.html"><span><b>4.3.2.</b> Bootstrapper</span></li><li class="chapter" data-level="4.3.3" data-path="4/4.3.html"><span><b>4.3.3.</b> Launcher</span></li><li class="chapter" data-level="4.3.4" data-path="4/4.3.html"><span><b>4.3.4.</b> Agent</span></li></ul></li><li class="chapter" data-level="4.4" data-path="4/4.4.html"><a href="../4/4.4.html"><i class="fa fa-check"></i> <b>4.4.</b> Common</a><ul class="articles"><li class="chapter" data-level="4.4.1" data-path="4/4.4.1.html"><a href="../4/4.4.1.html"><i class="fa fa-check"></i> <b>4.4.1.</b> Plugin Architecture</a></li><li class="chapter" data-level="4.4.2"><span><b>4.4.2.</b> [Agent - Server Communication](</span></li></ul></li><li class="chapter" data-level="4.5" data-path="4/4.5.html"><a href="../4/4.5.html"><i class="fa fa-check"></i> <b>4.5.</b> Build Infrastructure</a><ul class="articles"><li class="chapter" data-level="4.5.1" data-path="4/4.5.html"><span><b>4.5.1.</b> Build, Test, Package</span><ul class="articles"><li class="chapter" data-level="4.5.1.1" data-path="4/4.5.html"><span><b>4.5.1.1.</b> Maven modules</span></li><li class="chapter" data-level="4.5.1.2" data-path="4/4.5.html"><span><b>4.5.1.2.</b> Documentation Creation</span></li><li class="chapter" data-level="4.5.1.3" data-path="4/4.5.html"><span><b>4.5.1.3.</b> Pom conventions</span></li><li class="chapter" data-level="4.5.1.4" data-path="4/4.5.html"><span><b>4.5.1.4.</b> Jar Packaging</span></li><li class="chapter" data-level="4.5.1.5" data-path="4/4.5.html"><span><b>4.5.1.5.</b> TLB integration</span></li></ul></li><li class="chapter" data-level="4.5.2" data-path="4/4.5.html"><span><b>4.5.2.</b> Installer Creation</span><ul class="articles"><li class="chapter" data-level="4.5.2.1" data-path="4/4.5.html"><span><b>4.5.2.1.</b> Zip</span></li><li class="chapter" data-level="4.5.2.2" data-path="4/4.5.html"><span><b>4.5.2.2.</b> RPM</span></li><li class="chapter" data-level="4.5.2.3" data-path="4/4.5.html"><span><b>4.5.2.3.</b> Debian</span></li><li class="chapter" data-level="4.5.2.4" data-path="4/4.5.html"><span><b>4.5.2.4.</b> Windows</span></li><li class="chapter" data-level="4.5.2.5" data-path="4/4.5.html"><span><b>4.5.2.5.</b> Mac OS X</span></li><li class="chapter" data-level="4.5.2.6" data-path="4/4.5.html"><span><b>4.5.2.6.</b> Solaris</span></li></ul></li></ul></li></ul></li><li class="chapter" data-level="5" data-path="5/5.1.html"><a href="../5/5.1.html"><i class="fa fa-check"></i> <b>5.</b> Features</a><ul class="articles"><li class="chapter" data-level="5.1" data-path="5/5.1.html"><a href="../5/5.1.html"><i class="fa fa-check"></i> <b>5.1.</b> Dashboard</a><ul class="articles"><li class="chapter" data-level="5.1.1" data-path="5/5.1.html"><span><b>5.1.1.</b> Personalise</span></li><li class="chapter" data-level="5.1.2" data-path="5/5.1.html"><span><b>5.1.2.</b> Search</span></li><li class="chapter" data-level="5.1.3" data-path="5/5.1.html"><span><b>5.1.3.</b> Pipeline Group(s)</span></li><li class="chapter" data-level="5.1.4" data-path="5/5.1.html"><span><b>5.1.4.</b> Pipeline(s) and Ordering of pipeline instances</span></li><li class="chapter" data-level="5.1.5" data-path="5/5.1.html"><span><b>5.1.5.</b> Active Pipelines</span></li></ul></li><li class="chapter" data-level="5.2" data-path="5/5.2.html"><a href="../5/5.2.html"><i class="fa fa-check"></i> <b>5.2.</b> Fan-in</a><ul class="articles"><li class="chapter" data-level="5.2.1" data-path="5/5.2.html"><span><b>5.2.1.</b> Overview</span></li><li class="chapter" data-level="5.2.2" data-path="5/5.2.html"><span><b>5.2.2.</b> Pipeline Timeline</span></li><li class="chapter" data-level="5.2.3" data-path="5/5.2.html"><span><b>5.2.3.</b> Algorithm</span></li><li class="chapter" data-level="5.2.4" data-path="5/5.2.html"><span><b>5.2.4.</b> Corner Cases</span></li><li class="chapter" data-level="5.2.5" data-path="5/5.2.html"><span><b>5.2.5.</b> Extensions</span></li></ul></li><li class="chapter" data-level="5.3" data-path="5/5.3.html"><a href="../5/5.3.html"><i class="fa fa-check"></i> <b>5.3.</b> Value Stream Map</a><ul class="articles"><li class="chapter" data-level="5.3.1" data-path="5/5.3.html"><span><b>5.3.1.</b> Overview</span></li><li class="chapter" data-level="5.3.2" data-path="5/5.3.html"><span><b>5.3.2.</b> Layer Assignment</span></li><li class="chapter" data-level="5.3.3" data-path="5/5.3.html"><span><b>5.3.3.</b> Dummy Node Creation</span></li><li class="chapter" data-level="5.3.4" data-path="5/5.3.&lt;md id=&quot;edge-cross-mini&quot;&gt;&lt;/md&gt;mization.html"><span><b>5.3.4.</b> Edge Cross Minimisation</span></li><li class="chapter" data-level="5.3.5" data-path="5/5.3.html"><span><b>5.3.5.</b> Corner Cases</span></li><li class="chapter" data-level="5.3.6" data-path="5/5.3.html"><span><b>5.3.6.</b> Extensions</span></li></ul></li><li class="chapter" data-level="5.4" data-path="5/5.4.html"><a href="../5/5.4.html"><i class="fa fa-check"></i> <b>5.4.</b> Compare Pipeline</a><ul class="articles"><li class="chapter" data-level="5.4.1" data-path="5/5.4.html"><span><b>5.4.1.</b> Overview</span></li><li class="chapter" data-level="5.4.2" data-path="5/5.4.html"><span><b>5.4.2.</b> Implementation</span></li><li class="chapter" data-level="5.4.3" data-path="5/5.4.html"><span><b>5.4.3.</b> Corner cases</span></li></ul></li><li class="chapter" data-level="5.5" data-path="5/5.5.html"><a href="../5/5.5.html"><i class="fa fa-check"></i> <b>5.5.</b> PackageRepository</a><ul class="articles"><li class="chapter" data-level="5.5.1" data-path="5/5.5.html"><a href="../5/5.5.html"><i class="fa fa-check"></i> <b>5.5.1.</b> Overview</a></li><li class="chapter" data-level="5.5.2" data-path="5/5.5.html"><span><b>5.5.2.</b> Capturing Configuration</span></li><li class="chapter" data-level="5.5.3" data-path="5/5.5.html"><span><b>5.5.3.</b> Retrieving Package Revisions</span></li></ul></li><li class="chapter" data-level="5.6"><span><b>5.6.</b> Command Repository</span></li><li class="chapter" data-level="5.7" data-path="5/5.7.html"><a href="../5/5.7.html"><i class="fa fa-check"></i> <b>5.7.</b> Environments</a></li><li class="chapter" data-level="5.8"><span><b>5.8.</b> Templates</span></li><li class="chapter" data-level="5.9"><span><b>5.9.</b> Shine</span><ul class="articles"><li class="chapter" data-level="5.9.1"><span><b>5.9.1.</b> Test Artifact Parser</span></li><li class="chapter" data-level="5.9.2"><span><b>5.9.2.</b> Reporting</span></li><li class="chapter" data-level="5.9.3"><span><b>5.9.3.</b> Stage Graph</span></li></ul></li><li class="chapter" data-level="5.10" data-path="5/5.10.html"><a href="../5/5.10.html"><i class="fa fa-check"></i> <b>5.10.</b> OAuth Gadgets</a></li><li class="chapter" data-level="5.11" data-path="5/5.11.html"><a href="../5/5.11.html"><i class="fa fa-check"></i> <b>5.11.</b> Backup</a></li></ul></li><li class="chapter" data-level="6" data-path="writing_go_plugins/overview.html"><a href="../writing_go_plugins/overview.html"><i class="fa fa-check"></i> <b>6.</b> Writing Go Plugins</a><ul class="articles"><li class="chapter" data-level="6.1" data-path="4/4.4.1.html"><a href="../4/4.4.1.html"><i class="fa fa-check"></i> <b>6.1.</b> Go Plugin Architecture</a></li><li class="chapter" data-level="6.2" data-path="writing_go_plugins/go_plugins_basics.html"><a href="../writing_go_plugins/go_plugins_basics.html"><i class="fa fa-check"></i> <b>6.2.</b> Go Plugin Basics</a></li><li class="chapter" data-level="6.3" data-path="writing_go_plugins/go_plugin_api.html"><a href="../writing_go_plugins/go_plugin_api.html"><i class="fa fa-check"></i> <b>6.3.</b> Go Plugin API</a></li><li class="chapter" data-level="6.4" data-path="writing_go_plugins/json_message_based_plugin_api.html"><a href="../writing_go_plugins/json_message_based_plugin_api.html"><i class="fa fa-check"></i> <b>6.4.</b> JSON message based plugin API</a><ul class="articles"><li class="chapter" data-level="6.4.1" data-path="writing_go_plugins/angular_js_templates_in_go_plugins.html"><a href="../writing_go_plugins/angular_js_templates_in_go_plugins.html"><i class="fa fa-check"></i> <b>6.4.1.</b> Writing AngularJS templates</a></li><li class="chapter" data-level="6.4.2" data-path="writing_go_plugins/handling_web_requests.html"><a href="../writing_go_plugins/handling_web_requests.html"><i class="fa fa-check"></i> <b>6.4.2.</b> Handling Web Requests</a></li><li class="chapter" data-level="6.4.3" data-path="writing_go_plugins/plugin_settings/plugin_settings_overview.html"><a href="../writing_go_plugins/plugin_settings/plugin_settings_overview.html"><i class="fa fa-check"></i> <b>6.4.3.</b> Plugin Settings</a><ul class="articles"><li class="chapter" data-level="6.4.3.1" data-path="writing_go_plugins/plugin_settings/version_1_0/plugin_settings_configuration.html"><a href="../writing_go_plugins/plugin_settings/version_1_0/plugin_settings_configuration.html"><i class="fa fa-check"></i> <b>6.4.3.1.</b> Get Plugin Settings Configuration</a></li><li class="chapter" data-level="6.4.3.2" data-path="writing_go_plugins/plugin_settings/version_1_0/plugin_settings_view.html"><a href="../writing_go_plugins/plugin_settings/version_1_0/plugin_settings_view.html"><i class="fa fa-check"></i> <b>6.4.3.2.</b> Get Plugin Settings View</a></li><li class="chapter" data-level="6.4.3.3" data-path="writing_go_plugins/plugin_settings/version_1_0/validate_plugin_settings.html"><a href="../writing_go_plugins/plugin_settings/version_1_0/validate_plugin_settings.html"><i class="fa fa-check"></i> <b>6.4.3.3.</b> Validate Plugin Settings</a></li></ul></li></ul></li><li class="chapter" data-level="6.5" data-path="writing_go_plugins/go_application_accessor/go_application_accessor.html"><a href="../writing_go_plugins/go_application_accessor/go_application_accessor.html"><i class="fa fa-check"></i> <b>6.5.</b> Go Application Accessor</a><ul class="articles"><li class="chapter" data-level="6.5.1" data-path="writing_go_plugins/go_application_accessor/plugin_settings/plugin_settings.html"><a href="../writing_go_plugins/go_application_accessor/plugin_settings/plugin_settings.html"><i class="fa fa-check"></i> <b>6.5.1.</b> Plugin Settings</a><ul class="articles"><li class="chapter" data-level="6.5.1.1" data-path="writing_go_plugins/go_application_accessor/plugin_settings/version_1_0/get_plugin_settings.html"><a href="../writing_go_plugins/go_application_accessor/plugin_settings/version_1_0/get_plugin_settings.html"><i class="fa fa-check"></i> <b>6.5.1.1.</b> Get Plugin Settings</a></li></ul></li><li class="chapter" data-level="6.5.2" data-path="writing_go_plugins/go_application_accessor/user_session/user_session.html"><a href="../writing_go_plugins/go_application_accessor/user_session/user_session.html"><i class="fa fa-check"></i> <b>6.5.2.</b> User Session</a><ul class="articles"><li class="chapter" data-level="6.5.2.1" data-path="writing_go_plugins/go_application_accessor/user_session/version_1_0/put_into_user_session.html"><a href="../writing_go_plugins/go_application_accessor/user_session/version_1_0/put_into_user_session.html"><i class="fa fa-check"></i> <b>6.5.2.1.</b> Put into Session</a></li><li class="chapter" data-level="6.5.2.2" data-path="writing_go_plugins/go_application_accessor/user_session/version_1_0/get_from_user_session.html"><a href="../writing_go_plugins/go_application_accessor/user_session/version_1_0/get_from_user_session.html"><i class="fa fa-check"></i> <b>6.5.2.2.</b> Get from Session</a></li><li class="chapter" data-level="6.5.2.3" data-path="writing_go_plugins/go_application_accessor/user_session/version_1_0/remove_from_user_session.html"><a href="../writing_go_plugins/go_application_accessor/user_session/version_1_0/remove_from_user_session.html"><i class="fa fa-check"></i> <b>6.5.2.3.</b> Remove from Session</a></li></ul></li><li class="chapter" data-level="6.5.3" data-path="writing_go_plugins/go_application_accessor/user/user.html"><a href="../writing_go_plugins/go_application_accessor/user/user.html"><i class="fa fa-check"></i> <b>6.5.3.</b> Authenticate User</a><ul class="articles"><li class="chapter" data-level="6.5.3.1" data-path="writing_go_plugins/go_application_accessor/user/version_1_0/authenticate_user.html"><a href="../writing_go_plugins/go_application_accessor/user/version_1_0/authenticate_user.html"><i class="fa fa-check"></i> <b>6.5.3.1.</b> Authenticate User</a></li></ul></li></ul></li><li class="chapter" data-level="6.6" data-path="writing_go_plugins/package_material/package_material_plugin_overview.html"><a href="../writing_go_plugins/package_material/package_material_plugin_overview.html"><i class="fa fa-check"></i> <b>6.6.</b> Package material plugins</a><ul class="articles"><li class="chapter" data-level="6.6.1" data-path="writing_go_plugins/package_material/writing_go_package_material_plugin.html"><a href="../writing_go_plugins/package_material/writing_go_package_material_plugin.html"><i class="fa fa-check"></i> <b>6.6.1.</b> Java API based (Deprecated)</a></li><li class="chapter" data-level="6.6.2" data-path="writing_go_plugins/package_material/json_message_based_package_material_extension.html"><a href="../writing_go_plugins/package_material/json_message_based_package_material_extension.html"><i class="fa fa-check"></i> <b>6.6.2.</b> JSON API - Message based</a><ul class="articles"><li class="chapter" data-level="6.6.2.1" data-path="writing_go_plugins/package_material/version_1_0/repository_configuration.html"><a href="../writing_go_plugins/package_material/version_1_0/repository_configuration.html"><i class="fa fa-check"></i> <b>6.6.2.1.</b> Repository Configuration Request</a></li><li class="chapter" data-level="6.6.2.2" data-path="writing_go_plugins/package_material/version_1_0/package_configuration.html"><a href="../writing_go_plugins/package_material/version_1_0/package_configuration.html"><i class="fa fa-check"></i> <b>6.6.2.2.</b> Package Configuration Request</a></li><li class="chapter" data-level="6.6.2.3" data-path="writing_go_plugins/package_material/version_1_0/validate_repository_configuration.html"><a href="../writing_go_plugins/package_material/version_1_0/validate_repository_configuration.html"><i class="fa fa-check"></i> <b>6.6.2.3.</b> Validate Repository Configuration Request</a></li><li class="chapter" data-level="6.6.2.4" data-path="writing_go_plugins/package_material/version_1_0/validate_package_configuration.html"><a href="../writing_go_plugins/package_material/version_1_0/validate_package_configuration.html"><i class="fa fa-check"></i> <b>6.6.2.4.</b> Validate Package Configuration Request</a></li><li class="chapter" data-level="6.6.2.5" data-path="writing_go_plugins/package_material/version_1_0/check_repository_connection.html"><a href="../writing_go_plugins/package_material/version_1_0/check_repository_connection.html"><i class="fa fa-check"></i> <b>6.6.2.5.</b> Check Repository Connection Request</a></li><li class="chapter" data-level="6.6.2.6" data-path="writing_go_plugins/package_material/version_1_0/check_package_connection.html"><a href="../writing_go_plugins/package_material/version_1_0/check_package_connection.html"><i class="fa fa-check"></i> <b>6.6.2.6.</b> Check Repository Connection Request</a></li><li class="chapter" data-level="6.6.2.7" data-path="writing_go_plugins/package_material/version_1_0/latest_revision.html"><a href="../writing_go_plugins/package_material/version_1_0/latest_revision.html"><i class="fa fa-check"></i> <b>6.6.2.7.</b> Latest Revision Request</a></li><li class="chapter" data-level="6.6.2.8" data-path="writing_go_plugins/package_material/version_1_0/latest_revision_since.html"><a href="../writing_go_plugins/package_material/version_1_0/latest_revision_since.html"><i class="fa fa-check"></i> <b>6.6.2.8.</b> Latest Revision Since Request</a></li></ul></li></ul></li><li class="chapter" data-level="6.7" data-path="writing_go_plugins/scm_material/scm_material_plugin_overview.html"><a href="../writing_go_plugins/scm_material/scm_material_plugin_overview.html"><i class="fa fa-check"></i> <b>6.7.</b> SCM material plugins</a><ul class="articles"><li class="chapter" data-level="6.7.1" data-path="writing_go_plugins/scm_material/json_message_based_scm_material_extension.html"><a href="../writing_go_plugins/scm_material/json_message_based_scm_material_extension.html"><i class="fa fa-check"></i> <b>6.7.1.</b> JSON API - Message based</a><ul class="articles"><li class="chapter" data-level="6.7.1.1" data-path="writing_go_plugins/scm_material/version_1_0/scm_configuration.html"><a href="../writing_go_plugins/scm_material/version_1_0/scm_configuration.html"><i class="fa fa-check"></i> <b>6.7.1.1.</b> SCM Configuration Request</a></li><li class="chapter" data-level="6.7.1.2" data-path="writing_go_plugins/scm_material/version_1_0/view.html"><a href="../writing_go_plugins/scm_material/version_1_0/view.html"><i class="fa fa-check"></i> <b>6.7.1.2.</b> SCM View Request</a></li><li class="chapter" data-level="6.7.1.3" data-path="writing_go_plugins/scm_material/version_1_0/validate_scm_configuration.html"><a href="../writing_go_plugins/scm_material/version_1_0/validate_scm_configuration.html"><i class="fa fa-check"></i> <b>6.7.1.3.</b> Validate SCM Configuration Request</a></li><li class="chapter" data-level="6.7.1.4" data-path="writing_go_plugins/scm_material/version_1_0/check_scm_connection.html"><a href="../writing_go_plugins/scm_material/version_1_0/check_scm_connection.html"><i class="fa fa-check"></i> <b>6.7.1.4.</b> Check SCM Connection Request</a></li><li class="chapter" data-level="6.7.1.5" data-path="writing_go_plugins/scm_material/version_1_0/latest_revision.html"><a href="../writing_go_plugins/scm_material/version_1_0/latest_revision.html"><i class="fa fa-check"></i> <b>6.7.1.5.</b> Latest Revision Request</a></li><li class="chapter" data-level="6.7.1.6" data-path="writing_go_plugins/scm_material/version_1_0/latest_revisions_since.html"><a href="../writing_go_plugins/scm_material/version_1_0/latest_revisions_since.html"><i class="fa fa-check"></i> <b>6.7.1.6.</b> Latest Revisions Since Request</a></li><li class="chapter" data-level="6.7.1.7" data-path="writing_go_plugins/scm_material/version_1_0/checkout.html"><a href="../writing_go_plugins/scm_material/version_1_0/checkout.html"><i class="fa fa-check"></i> <b>6.7.1.7.</b> Checkout Request</a></li></ul></li></ul></li><li class="chapter" data-level="6.8" data-path="writing_go_plugins/task/task_plugin_overview.html"><a href="../writing_go_plugins/task/task_plugin_overview.html"><i class="fa fa-check"></i> <b>6.8.</b> Task plugins</a><ul class="articles"><li class="chapter" data-level="6.8.1" data-path="writing_go_plugins/task/writing_go_task_plugins.html"><a href="../writing_go_plugins/task/writing_go_task_plugins.html"><i class="fa fa-check"></i> <b>6.8.1.</b> Java API based (Deprecated)</a></li><li class="chapter" data-level="6.8.2" data-path="writing_go_plugins/task/json_message_based_task_extension.html"><a href="../writing_go_plugins/task/json_message_based_task_extension.html"><i class="fa fa-check"></i> <b>6.8.2.</b> JSON API - Message based</a><ul class="articles"><li class="chapter" data-level="6.8.2.1" data-path="writing_go_plugins/task/version_1_0/configuration.html"><a href="../writing_go_plugins/task/version_1_0/configuration.html"><i class="fa fa-check"></i> <b>6.8.2.1.</b> Task Configuration Request</a></li><li class="chapter" data-level="6.8.2.2" data-path="writing_go_plugins/task/version_1_0/validate.html"><a href="../writing_go_plugins/task/version_1_0/validate.html"><i class="fa fa-check"></i> <b>6.8.2.2.</b> Validate Configuration Request</a></li><li class="chapter" data-level="6.8.2.3" data-path="writing_go_plugins/task/version_1_0/execute.html"><a href="../writing_go_plugins/task/version_1_0/execute.html"><i class="fa fa-check"></i> <b>6.8.2.3.</b> Execute Task Request</a></li><li class="chapter" data-level="6.8.2.4" data-path="writing_go_plugins/task/version_1_0/view.html"><a href="../writing_go_plugins/task/version_1_0/view.html"><i class="fa fa-check"></i> <b>6.8.2.4.</b> Task View Request</a></li></ul></li></ul></li><li class="chapter" data-level="6.9" data-path="writing_go_plugins/notification/notification_plugin_overview.html"><a href="../writing_go_plugins/notification/notification_plugin_overview.html"><i class="fa fa-check"></i> <b>6.9.</b> Notification plugins</a><ul class="articles"><li class="chapter" data-level="6.9.1" data-path="writing_go_plugins/notification/json_message_based_notification_extension.html"><a href="../writing_go_plugins/notification/json_message_based_notification_extension.html"><i class="fa fa-check"></i> <b>6.9.1.</b> JSON API - Message based</a><ul class="articles"><li class="chapter" data-level="6.9.1.1" data-path="writing_go_plugins/notification/version_1_0/notifications_interested_in.html"><a href="../writing_go_plugins/notification/version_1_0/notifications_interested_in.html"><i class="fa fa-check"></i> <b>6.9.1.1.</b> Notifications Interested In</a></li><li class="chapter" data-level="6.9.1.2" data-path="writing_go_plugins/notification/version_1_0/stage_status_notification.html"><a href="../writing_go_plugins/notification/version_1_0/stage_status_notification.html"><i class="fa fa-check"></i> <b>6.9.1.2.</b> Stage Status Change Notification</a></li></ul></li></ul></li><li class="chapter" data-level="6.10" data-path="writing_go_plugins/authentication/authentication_plugin_overview.html"><a href="../writing_go_plugins/authentication/authentication_plugin_overview.html"><i class="fa fa-check"></i> <b>6.10.</b> Authentication plugins</a><ul class="articles"><li class="chapter" data-level="6.10.1" data-path="writing_go_plugins/authentication/json_message_based_authentication_extension.html"><a href="../writing_go_plugins/authentication/json_message_based_authentication_extension.html"><i class="fa fa-check"></i> <b>6.10.1.</b> JSON API - Message based</a><ul class="articles"><li class="chapter" data-level="6.10.1.1" data-path="writing_go_plugins/authentication/version_1_0/plugin_configuration.html"><a href="../writing_go_plugins/authentication/version_1_0/plugin_configuration.html"><i class="fa fa-check"></i> <b>6.10.1.1.</b> Plugin Configuration</a></li><li class="chapter" data-level="6.10.1.2" data-path="writing_go_plugins/authentication/version_1_0/authenticate_user.html"><a href="../writing_go_plugins/authentication/version_1_0/authenticate_user.html"><i class="fa fa-check"></i> <b>6.10.1.2.</b> Authenticate User</a></li><li class="chapter" data-level="6.10.1.3" data-path="writing_go_plugins/authentication/version_1_0/search_user.html"><a href="../writing_go_plugins/authentication/version_1_0/search_user.html"><i class="fa fa-check"></i> <b>6.10.1.3.</b> Search User</a></li></ul></li></ul></li><li class="chapter" data-level="6.11" data-path="writing_go_plugins/task/angular_js_templates_in_go_plugins.html"><span><b>6.11.</b> Angular JS templates in Go plugins</span></li></ul></li><li class="chapter" data-level="7" data-path="7/7.1.html"><a href="../7/7.1.html"><i class="fa fa-check"></i> <b>7.</b> CD in practice</a><ul class="articles"><li class="chapter" data-level="7.1" data-path="7/7.1.html"><a href="../7/7.1.html"><i class="fa fa-check"></i> <b>7.1.</b> Build Go Using Go</a></li><li class="chapter" data-level="7.2" data-path="7/7.2.html"><a href="../7/7.2.html"><i class="fa fa-check"></i> <b>7.2.</b> Test Infrastructure</a><ul class="articles"><li class="chapter" data-level="7.2.1" data-path="7/7.2.html"><span><b>7.2.1.</b> Rails specs using RSpec</span></li><li class="chapter" data-level="7.2.2" data-path="7/7.2.html"><span><b>7.2.2.</b> Java testing using JUnit</span></li><li class="chapter" data-level="7.2.3" data-path="7/7.2.html"><span><b>7.2.3.</b> Javascript testing using JsUnit Tests</span></li><li class="chapter" data-level="7.2.4" data-path="7/7.2.html"><span><b>7.2.4.</b> Acceptance &amp; Regression tests using Twist</span><ul class="articles"><li class="chapter" data-level="7.2.4.1" data-path="7/7.2.html"><span><b>7.2.4.1.</b> Performance Tests</span></li></ul></li><li class="chapter" data-level="7.2.5" data-path="7/7.2.html"><span><b>7.2.5.</b> Test Parallelization</span></li></ul></li><li class="chapter" data-level="7.3"><span><b>7.3.</b> Continuous Deployment</span></li></ul></li><li class="chapter" data-level="8" data-path="8/8.1.html"><a href="../8/8.1.html"><i class="fa fa-check"></i> <b>8.</b> Miscellaneous</a><ul class="articles"><li class="chapter" data-level="8.1" data-path="8/8.1.html"><a href="../8/8.1.html"><i class="fa fa-check"></i> <b>8.1.</b> Technical Debt</a></li></ul></li><li class="divider"></li><li><a href="https://www.gitbook.com" target="blank" class="gitbook-link">Published with GitBook</a></li></ul></div><div class="book-body"><div class="body-inner"><div class="book-header"><a href="#" class="btn pull-left toggle-summary" aria-label="Table of Contents"><i class="fa fa-align-justify"></i></a> <a href="#" class="btn pull-left toggle-search" aria-label="Search"><i class="fa fa-search"></i></a><div id="font-settings-wrapper" class="dropdown pull-left"><a href="#" class="btn toggle-dropdown" aria-label="Font Settings"><i class="fa fa-font"></i></a><div class="dropdown-menu font-settings"><div class="dropdown-caret"><span class="caret-outer"></span> <span class="caret-inner"></span></div><div class="buttons"><button type="button" id="reduce-font-size" class="button size-2">A</button> <button type="button" id="enlarge-font-size" class="button size-2">A</button></div><div class="buttons font-family-list"><button type="button" data-font="0" class="button">Serif</button> <button type="button" data-font="1" class="button">Sans</button></div><div class="buttons color-theme-list"><button type="button" id="color-theme-preview-0" class="button size-3" data-theme="0">White</button> <button type="button" id="color-theme-preview-1" class="button size-3" data-theme="1">Sepia</button> <button type="button" id="color-theme-preview-2" class="button size-3" data-theme="2">Night</button></div></div></div><div class="dropdown pull-right"><a href="#" class="btn toggle-dropdown" aria-label="Share"><i class="fa fa-share-alt"></i></a><div class="dropdown-menu font-settings dropdown-left"><div class="dropdown-caret"><span class="caret-outer"></span> <span class="caret-inner"></span></div><div class="buttons"><button type="button" data-sharing="twitter" class="button">Share on Twitter</button> <button type="button" data-sharing="google-plus" class="button">Share on Google</button> <button type="button" data-sharing="facebook" class="button">Share on Facebook</button> <button type="button" data-sharing="weibo" class="button">Share on Weibo</button> <button type="button" data-sharing="instapaper" class="button">Share on Instapaper</button></div></div></div><a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Google"><i class="fa fa-google-plus"></i></a> <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Facebook"><i class="fa fa-facebook"></i></a> <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Twitter"><i class="fa fa-twitter"></i></a><h1><i class="fa fa-circle-o-notch fa-spin"></i> <a href="../">Go Developer Documentation</a></h1></div><div class="page-wrapper" tabindex="-1"><div class="page-inner"><section class="normal" id="section-"><h2 id="4-2-go-server"><a name="4-2-go-server" class="plugin-anchor" href="#4-2-go-server"><span class="fa fa-link"></span></a>4.2 Go Server</h2><p>The Go server is made up of multiple sub-systems, communicating between themselves using ActiveMQ message queues and the database. The main sub-systems in the Go server are:</p><ul><li>Material update sub-system</li><li>Scheduling sub-system</li><li>Work assignment sub-system</li></ul><h3 id="material-update-sub-system-mdu"><a name="material-update-sub-system-mdu" class="plugin-anchor" href="#material-update-sub-system-mdu"><span class="fa fa-link"></span></a>Material update sub-system (MDU)</h3><p>This sub-system is called MDU for historical reasons (originally, &quot;Material Database Updater&quot;). It runs off of a timer and a method is invoked on it periodically. Every time it gets called, it does this:</p><ul><li>Checks each material to see if there are any new commits.</li><li>If found, it puts information about them into the database (modifications).</li></ul><p>You can read more about this <a href="#423-material-update-sub-system">here</a>.</p><h3 id="scheduling-sub-system-scheduler"><a name="scheduling-sub-system-scheduler" class="plugin-anchor" href="#scheduling-sub-system-scheduler"><span class="fa fa-link"></span></a>Scheduling sub-system (Scheduler)</h3><p>It runs off a timer and a method is invoked on it periodically. Every time it gets called, it does this:</p><ul><li>For every automatically schedulable pipeline (ignoring timer triggered pipelines, manual pipelines, paused pipelines, etc), checks if any new modification is available for one of its materials.</li><li>If available, it schedules a build (creates jobs to be run).</li></ul><p>You can read more about this <a href="#425-pipeline-scheduling">here</a>.</p><h3 id="work-assignment-sub-system"><a name="work-assignment-sub-system" class="plugin-anchor" href="#work-assignment-sub-system"><span class="fa fa-link"></span></a>Work assignment sub-system</h3><p>This sub-system gets activated by the agent communicating with the server. Every time an agent communicates with the server, the server assigns a matching job to the agent, based on the job&apos;s resources and environment.</p><p>You can read more about this <a href="#426-work-assignment">here</a>.</p><h3 id="other-sub-systems"><a name="other-sub-systems" class="plugin-anchor" href="#other-sub-systems"><span class="fa fa-link"></span></a>Other sub-systems</h3><p>Apart from these three main sub-systems, there are some other sub-systems and modules worth mentioning:</p><ul><li>Configuration management module</li><li>User interface (UI) sub-system</li><li>Plugin sub-system</li></ul><h4 id="configuration-management-module"><a name="configuration-management-module" class="plugin-anchor" href="#configuration-management-module"><span class="fa fa-link"></span></a>Configuration management module</h4><p>Largely made up of the two smaller modules, config-server and config-api, in code, the configuration management module is responsible for all of the activities around serializing and deserializing the configuration object from and to the configuration XML.</p><p>You can read more about this <a href="#421-configuration-management">here</a>.</p><h4 id="user-interface-ui-sub-system"><a name="user-interface-ui-sub-system" class="plugin-anchor" href="#user-interface-ui-sub-system"><span class="fa fa-link"></span></a>User interface (UI) sub-system</h4><p>This subsystem is composed mainly of a Rails application running on JRuby, fronted by the Jetty web server, with Spring&apos;s Web MVC framework for the servlets. All HTTP and HTTPS requests get routed through Jetty and Spring, through a URL rewriting layer and then comes to Rails&apos; routing layer.</p><p>You can read more about this <a href="#4210-user-interface-architecture">here</a>.</p><h4 id="plugin-sub-system"><a name="plugin-sub-system" class="plugin-anchor" href="#plugin-sub-system"><span class="fa fa-link"></span></a>Plugin sub-system</h4><p>This sub-system is responsible for communication with all the plugins in the system and the framework around them, including installation and registration, to handling missing plugins. It is used by other sub-systems, as needed. In code, the modules involved in this sub-system are go-plugin-api, go-plugin-activator, go-plugin-infra and go-plugin-internal-api.</p><p>You can read more about this <a href="4.4.html">here</a>.</p><h3 id="-a-name-421-configuration-management-a-4-2-1-configuration-management"><a name="-a-name-421-configuration-management-a-4-2-1-configuration-management" class="plugin-anchor" href="#-a-name-421-configuration-management-a-4-2-1-configuration-management"><span class="fa fa-link"></span></a><a name="421-configuration-management"></a>4.2.1 Configuration Management</h3><p>There are multiple ways to configure Go:</p><ul><li>Admin interface in UI - These let you modify only specific section of the config</li><li>Config XML tab in Administration section - This would let you modify the entire config at one place, however requires a deeper understanding of the xml</li><li>Config API - If you do not like using the UI, config API is meant for you, however, this again deals with plain xml</li><li>Changes made to config file through file system</li></ul><p>Go configuration is saved to a file store <code>cruise-config.xml</code> and immaterial of the method chosen, changes would be save to the same file.</p><h4 id="4-2-1-1-xsd-xml"><a name="4-2-1-1-xsd-xml" class="plugin-anchor" href="#4-2-1-1-xsd-xml"><span class="fa fa-link"></span></a>4.2.1.1 XSD &amp; XML</h4><p><code>cruise-config.xml</code> conforms to the <em>cruise-config.xsd</em>. The xml is deserialized to <code>CruiseConfig</code> before being passed around in code, the same is then serialized at the time of save into the xml format.</p><p>A number of validations are run before a config change would be saved:</p><ul><li>XSD validation to ensure the schema is correct</li><li>Validations performed by the class representation of xml elements (via the Validatable interface)</li><li>Miscelleneous validations performed by implementors of GoConfigValidator</li></ul><p>Since, the config file is a simple xml file placed on the file system, changes to this file can be made by editing this file. However, any changes to this file would go through the same validation process.</p><p><code>config-api</code> and <code>config-server</code> modules deal with configuration management. While <code>config-api</code> is shared by both Go server and agent, <code>config-server</code> is exclusively referenced by Go server.</p><h4 id="4-2-1-2-schema-migration"><a name="4-2-1-2-schema-migration" class="plugin-anchor" href="#4-2-1-2-schema-migration"><span class="fa fa-link"></span></a>4.2.1.2 Schema Migration</h4><p>Go being an ongoing project, there are bound to be changes to the config schema. However, as Go has been in production for a few years now, we need to ensure that all existing users can upgrade smoothly without any manual intervention. In order to achieve this, every change to the schema is assigned a <em>schemaVersion</em>, and a XSLT migration is written to ensure configuration upgrade happen in an automatic fashion. During server upgrade, all the xslt migrations from the current version until latest would be executed in a sequential fashion.</p><p>To elaborate this further, lets say the current schemaVersion is <em>100</em> and we wish to edit an existing node in the xsd. Writing a schema migration for the same would involve a few steps:</p><ol><li><p>Make a copy of the current cruise-config.xsd, and place it at <code>config/config-server/resources/schemas/100_cruise-config.xsd</code></p></li><li><p>Make the relevant changes to the cruise-config.xsd file. Update the schemaVersion tag to &apos;101&apos;.</p></li><li><p>Write an xslt migration <code>config/config-server/resources/upgrades/101.xsl</code> to migrate a config on version 100 to version 101.</p></li><li><p>Write an integration test to cover the above change.</p></li></ol><h4 id="4-2-1-3-config-repository"><a name="4-2-1-3-config-repository" class="plugin-anchor" href="#4-2-1-3-config-repository"><span class="fa fa-link"></span></a>4.2.1.3 Config Repository</h4><p>Go configuration is version controlled in a local git repository, <em>config.git</em> hosted on the Server machine. Any changes to the config, either through file-system or through Go dashboard would be saved as a commit on this repo. As such all changes to the config can be audited or reverted if need be.</p><p>All interactions to the repo is done using jgit, and the repo itself is managed by <code>ConfigRepository</code>. The commits made to this repository need to be in a certain format and hence manual changes/commits to this repo would cause errors in Go.</p><h4 id="4-2-1-4-config-merge"><a name="4-2-1-4-config-merge" class="plugin-anchor" href="#4-2-1-4-config-merge"><span class="fa fa-link"></span></a>4.2.1.4 Config Merge</h4><p>Building upon the config repository feature, Go makes use of <em>git merge</em> to support concurrent modifications to the config file. When a user makes a request to <code>get</code> the config, the computed MD5 of config is also sent as a part of the response, this MD5 would be submitted as post data when the user submits their change. If the submitted MD5 matches that of the latest config, the new change would be saved, of course if the validations pass.<br>If the submitted MD5 doesnot match, a need to merge config arises. To elaborate on this, consider two users user1 and user2 trying to change the config concurrently. Both submit their changes with say &apos;md5-10&apos; as the MD5 value. Lets say the latest commit on config.git is &apos;git-sha-10&apos; with MD5 value &apos;md5-10&apos;. Say user1&apos;s request was received first, and a new commit &apos;git-sha-11&apos; with MD5 &apos;md5-11&apos; was made to the repo corresponding to user1&apos;s change. Now, the request from user2 is received, since the MD5 from request does not match the latest MD5, a need to merge arises.</p><p>By default Go works on master, however to deal with the above scenario, two new branches would be created. &apos;branch-at-head&apos; is at the same revision as master. &apos;branch-at-revision&apos; is at revision &apos;git-sha-10&apos; (ie. the revision corresponding to the MD5 that user2 knows about). The changes made by user2 are committed to &apos;branch-at-revision&apos;. &apos;branch-at-revision&apos; will then be merged to &apos;branch-at-head&apos;. If the merge is successful, the changes from the merged commit would be committed to master. If the merge fails, config save would not go through and an error is thrown to the user.</p><h4 id="4-2-1-5-config-diff"><a name="4-2-1-5-config-diff" class="plugin-anchor" href="#4-2-1-5-config-diff"><span class="fa fa-link"></span></a>4.2.1.5 Config Diff</h4><p>The MD5 of the config corresponding to each stage run is saved in the database. Users can hence view the changes that have been made to the config between the multiple runs of a given stage. Go would get the git SHA corresponding to a given MD5 value. Jgit gives the diff between the two revisions which could be seen on the stage details page.</p><h3 id="4-2-2-database-management"><a name="4-2-2-database-management" class="plugin-anchor" href="#4-2-2-database-management"><span class="fa fa-link"></span></a>4.2.2 Database Management</h3><p>Go uses <a href="http://www.h2database.com/" target="_blank">H2 Database</a> as its choice of data store. In Go, H2 operates in an embedded mode, loaded into Go&apos;s JVM. As of the time this document was written, the H2 version in use was 1.3.168.</p><h4 id="4-2-2-1-schema"><a name="4-2-2-1-schema" class="plugin-anchor" href="#4-2-2-1-schema"><span class="fa fa-link"></span></a>4.2.2.1 Schema</h4><p>The database schema is primed as part of the database migration scripts that run during startup. An overview of the database schema is shown below:</p><p><img src="images/database_schema.png" alt="Database schema"></p><h4 id="4-2-2-2-database-migrations"><a name="4-2-2-2-database-migrations" class="plugin-anchor" href="#4-2-2-2-database-migrations"><span class="fa fa-link"></span></a>4.2.2.2 Database migrations</h4><p>Go uses <a href="https://code.google.com/p/dbdeploy/" target="_blank">DB Deploy</a> to run DDLs/DMLs on the H2 database instance named <strong>cruise.h2.db</strong>. The deltas are added under</p><pre><code>~/projects/go$ cd server/db/migrate/h2deltas
~/projects/go/server/db/migrate/h2deltas$ ls
10_add_stage_timestamp.sql
35_rename_usersettings_table.sql
...
</code></pre><p>The naming scheme that is followed is</p><pre><code>&lt; 2 character major release number &gt;&lt; 2 character minor release number &gt;&lt; 3 character migration number &gt;_&lt; migration file name &gt;.sql
</code></pre><p>For example, for major release 14, minor release 02 and migration number 005, the file name would be: <strong>1402005_create_a_table_for_something.sql</strong></p><p>A guide on how to add a database migration can be found <a href="../2/2.4.html">here</a>.</p><h3 id="4-2-2-3-backup"><a name="4-2-2-3-backup" class="plugin-anchor" href="#4-2-2-3-backup"><span class="fa fa-link"></span></a>4.2.2.3 Backup</h3><p>At the filesystem level, backing up the database includes copying over the <code>cruise.h2.db</code> file. The <em>backup</em> feature in Go utilizes a <a href="http://www.h2database.com/html/grammar.html?highlight=backup&amp;search=backup#backup" target="_blank">H2 feature</a> which helps taking a hot backup of the database while it is in use. <code>com.thoughtworks.go.server.service.BackupService</code>, along with other items, backups the H2 database as well. The <code>void backupDb(File)</code> method is the starting point of the execution flow which achieves this.</p><pre><code>com.thoughtworks.go.server.service.BackupService

...
private void backupDb(File backupDir) throws SQLException {
        databaseStrategy.backup(backupDir);
}
...
</code></pre><h3 id="-a-name-423-material-update-sub-system-a-4-2-3-material-update-sub-system-mdu"><a name="-a-name-423-material-update-sub-system-a-4-2-3-material-update-sub-system-mdu" class="plugin-anchor" href="#-a-name-423-material-update-sub-system-a-4-2-3-material-update-sub-system-mdu"><span class="fa fa-link"></span></a><a name="423-material-update-sub-system"></a> 4.2.3 Material update sub-system (MDU)</h3><p>This sub-system is called MDU for historical reasons (originally, &quot;Material Database Updater&quot;). As its name suggests, its job is to update the materials configured in the system to their latest state. For SCM materials, this means recording commits which have happened since the last time they were checked; for package materials, this means giving the plugins a chance to find newly uploaded packages, and so on.</p><p>Here is an overview of its internals:</p><hr><p><img src="images/mdu_overview.png" alt="MDU"></p><hr><p>The MDU (specifically, the <code>MaterialUpdateService</code> class being the starting point of this sub-system), gets a timer triggered callback periodically. When it gets that, it uses the configuration to find all the <a href="#5231-material-fingerprint--flyweights">unique materials</a> across pipelines.</p><p>For each unique material found, it sends a message to the <code>MaterialUpdateQueue</code>. Now, the <code>MaterialUpdateListeners</code> will pick up the messages and do an MDU check for the material specified in the message. Once a new commit is seen, they use the <code>MaterialRepository</code> to insert information about the commit into the database. This information about the commit is called &quot;Modification&quot;.</p><p>Once this update is done (or no new commit or change was found), a message is sent back to the <code>MaterialUpdateCompletedTopic</code> to notify other parts of the system that an MDU check was completed. This message is subscribed to and listened for by the scheduler sub-system as well as the MDU itself to do various tasks they need to do after an MDU check is done.</p><h3 id="some-other-concepts-related-to-the-mdu"><a name="some-other-concepts-related-to-the-mdu" class="plugin-anchor" href="#some-other-concepts-related-to-the-mdu"><span class="fa fa-link"></span></a>Some other concepts related to the MDU</h3><h4 id="idle-time"><a name="idle-time" class="plugin-anchor" href="#idle-time"><span class="fa fa-link"></span></a>Idle time</h4><p>Not every unique material found will actually be checked every time. There is a configurable &quot;idle&quot; time (defined by the system property <code>material.update.idle.interval</code>), which specifies the minimum time which should elapse between two MDU checks for a material. Every time the timer is triggered, this interval is checked. If the MDU check for this material has been run within the interval time, the material is skipped and will be checked again, when the timer is triggered the next time.</p><h4 id="in-progress-material-update"><a name="in-progress-material-update" class="plugin-anchor" href="#in-progress-material-update"><span class="fa fa-link"></span></a>In-progress material update</h4><p>If a material update takes a long time, longer than the timer interval, then there is a possibility of another MDU check starting for the same material. This can cause issues with version control systems. To prevent this, the server keeps track of every material in the queue and makes sure that another MDU check will not start for the same material. If a material is taking a long time to update, then you might see a log message about skipping its update and about it being in-progress.</p><h4 id="4-2-3-1-material-fingerprint-flyweights"><a name="4-2-3-1-material-fingerprint-flyweights" class="plugin-anchor" href="#4-2-3-1-material-fingerprint-flyweights"><span class="fa fa-link"></span></a>4.2.3.1 Material Fingerprint &amp; Flyweights</h4><p><strong>WIP</strong></p><h4 id="4-2-3-2-supported-materials"><a name="4-2-3-2-supported-materials" class="plugin-anchor" href="#4-2-3-2-supported-materials"><span class="fa fa-link"></span></a>4.2.3.2 Supported Materials</h4><p><strong>WIP</strong></p><h3 id="4-2-4-build-cause-production"><a name="4-2-4-build-cause-production" class="plugin-anchor" href="#4-2-4-build-cause-production"><span class="fa fa-link"></span></a>4.2.4 Build Cause Production</h3><p><strong>WIP</strong></p><h3 id="-a-name-425-pipeline-scheduling-a-4-2-5-pipeline-scheduling"><a name="-a-name-425-pipeline-scheduling-a-4-2-5-pipeline-scheduling" class="plugin-anchor" href="#-a-name-425-pipeline-scheduling-a-4-2-5-pipeline-scheduling"><span class="fa fa-link"></span></a><a name="425-pipeline-scheduling"></a> 4.2.5 Pipeline Scheduling</h3><p><strong>WIP</strong></p><h3 id="-a-name-426-work-assignment-a-4-2-6-work-assignment"><a name="-a-name-426-work-assignment-a-4-2-6-work-assignment" class="plugin-anchor" href="#-a-name-426-work-assignment-a-4-2-6-work-assignment"><span class="fa fa-link"></span></a><a name="426-work-assignment"></a> 4.2.6 Work Assignment</h3><p><strong>WIP</strong></p><h4 id="4-2-6-1-resource-environment-mapping"><a name="4-2-6-1-resource-environment-mapping" class="plugin-anchor" href="#4-2-6-1-resource-environment-mapping"><span class="fa fa-link"></span></a>4.2.6.1 Resource &amp; Environment Mapping</h4><p><strong>WIP</strong></p><h3 id="4-2-7-artifact-management"><a name="4-2-7-artifact-management" class="plugin-anchor" href="#4-2-7-artifact-management"><span class="fa fa-link"></span></a>4.2.7 Artifact Management</h3><p><strong>WIP</strong></p><h3 id="4-2-8-user-management"><a name="4-2-8-user-management" class="plugin-anchor" href="#4-2-8-user-management"><span class="fa fa-link"></span></a>4.2.8 User Management</h3><p><strong>WIP</strong></p><h4 id="4-2-8-1-authentication-management"><a name="4-2-8-1-authentication-management" class="plugin-anchor" href="#4-2-8-1-authentication-management"><span class="fa fa-link"></span></a>4.2.8.1 Authentication Management</h4><p><strong>WIP</strong></p><h4 id="4-2-8-2-enable-disable-delete-users"><a name="4-2-8-2-enable-disable-delete-users" class="plugin-anchor" href="#4-2-8-2-enable-disable-delete-users"><span class="fa fa-link"></span></a>4.2.8.2 Enable, disable &amp; delete users</h4><p><strong>WIP</strong></p><h4 id="4-2-8-3-user-role-management"><a name="4-2-8-3-user-role-management" class="plugin-anchor" href="#4-2-8-3-user-role-management"><span class="fa fa-link"></span></a>4.2.8.3 User Role Management</h4><p><strong>WIP</strong></p><h3 id="4-2-9-agent-management"><a name="4-2-9-agent-management" class="plugin-anchor" href="#4-2-9-agent-management"><span class="fa fa-link"></span></a>4.2.9 Agent Management</h3><p><strong>WIP</strong></p><h3 id="-a-name-4210-user-interface-architecture-a-4-2-10-user-interface-architecture"><a name="-a-name-4210-user-interface-architecture-a-4-2-10-user-interface-architecture" class="plugin-anchor" href="#-a-name-4210-user-interface-architecture-a-4-2-10-user-interface-architecture"><span class="fa fa-link"></span></a><a name="4210-user-interface-architecture"></a>4.2.10 User Interface Architecture</h3><p>As we mentioned we are using .html.erb(Rails) and .vm(Velocity) files for writing our markup and .SCSS for styling, so it will get converted into HTML and CSS by their respective frameworks. And we are using jQuery for API calling and event binding.</p><p>Most of the front-end files resides inside <code>rails/app</code> folder where we have folders called <code>views</code> and <code>vm</code>, which groups all the <code>.ERBs</code> and <code>.VMs</code> respectively.</p><p>Now let&apos;s understand, how the UI is architected in the Go. And understand how HTML, CSS, and JavaScript is organized.</p><h3 id="4-2-10-1-markup-html"><a name="4-2-10-1-markup-html" class="plugin-anchor" href="#4-2-10-1-markup-html"><span class="fa fa-link"></span></a>4.2.10.1. Markup : HTML</h3><p>We&apos;ve already talked about versioning part. So lets directly jump into file structure. HTML part is little complex, as we are using two different frameworks. Most of the files are inside <code>app/views</code> folder, where we have very modular structure and various type of markup files.</p><ul><li><p><strong>Layout Files</strong>: All the layout files are inside a folder called <code>views/layouts</code>, where we&apos;ve kept all the common files getting used by the other pages. We&apos;ve various layout files like <code>admin</code>, <code>agents</code>, <code>pipelines</code>, <code>value-stream-map</code> etc.</p></li><li><p><strong>Shared Files</strong>: The files which are getting used at more than one files or layouts, we&apos;ve kept all of them in two shared folders. Both the frameworks, Rails and Velocity has their <code>shared</code> folder.</p></li><li><p><strong>Other Files</strong>: All the other files are grouped according to concepts or module.</p></li></ul><p>Generally, we do use .erb almost everywhere, except few places like Job Details, Pipeline History, Login and Preference. We&apos;ve .vm files for these other pages.</p><h5 id="spec-tests-for-markup"><a name="spec-tests-for-markup" class="plugin-anchor" href="#spec-tests-for-markup"><span class="fa fa-link"></span></a>Spec tests for Markup</h5><p>We&apos;ve a spec testing framework integrated to validate or test rails markup. We&apos;ve a stage configured for it, which will do automatic testing of markup. It will compare current result with the expected to find out any regression.</p><h4 id="4-2-10-2-styling-css-sass"><a name="4-2-10-2-styling-css-sass" class="plugin-anchor" href="#4-2-10-2-styling-css-sass"><span class="fa fa-link"></span></a>4.2.10.2. Styling : CSS, SASS</h4><p>As mentioned earlier, we are not going to write plain CSS anymore but SASS. So, the compilation and conversion of SASS to CSS will be taken care by a rails <code>sass</code> gem.</p><p>As mentioned in UI tech stack chapter, we are restructuring our front-end CSS structure as well, here is what it will looks like eventually, we&apos;ve started with moving few css rules from CSS files to their relative SCSS files.</p><pre><code>base
  |--mixins.sass
  |--reset-g9.sass
  |--sprites.scss
  |--variables.scss
components
  |--alerts.scss
  |--labels-badges.scss
  |--messages.sass
  |--navbar.scss
  |--pagination.scss
  |--treenav.sass
  |--wizard.sass
gadgets
  |--breadcrumb.scss
  |--button-groups.scss
  |--docked-toolbar.scss
  |--dropdowns.scss
  |--forms.scss
  |--layouts.sass
  |--modals.scss
  |--popovers.scss
  |--progress-bars.scss
  |--scaffolding.scss
  |--tabs.sass
  |--tooltip.scss
global
  |--layout.scss
  |--reset.scss
  |--responsive.scss
  |--typography.scss
go-pages
  admin
      |--template.sass        
  |--agent.scss
  |--admin.scss
  |--admin/templates.scss
  |--vsm.scss
  |--history-panel.scss
  |--pipeline.scss
</code></pre><p>We&apos;ve lots of CSS files for individual UI elements inside <code>stylesheets</code>. As well as we&apos;ve a file called <code>application.css</code> inside <code>webapp/css</code> folder, where we&apos;ve defined the application level style rules.</p><p>All the CSS files inside different folders of <code>stylesheets</code> folder will be merged into a single file inside their respective folders. E.g. all the CSS files in <code>patterns</code> folder will be merged as <code>patterns.css</code> and will be there in patterns folder. And all the files inside <code>sass</code> folder will be eventually merged into a file called <code>css_sass.css</code> by a method written in helper file.</p><p><strong>How to add a new SCSS file?</strong> After adding a .SCSS file inside any folder mentioned above, you will have to refer or include them in two different places <code>_css.html.erb</code> and <code>_header.vm</code> depends on where you want to use.</p><p><strong>How to update changed SCSS file?</strong> You can run following command after modifying the content in any .scss file. <code>cd server/webapp/sass &amp;&amp; sass --update .:../stylesheets/css_sass &amp;&amp; cd ../../..</code>. Or you can add <code>--watch</code> attribute for live update.</p><h4 id="4-2-10-3-scripting-javascript-jquery-and-prototype"><a name="4-2-10-3-scripting-javascript-jquery-and-prototype" class="plugin-anchor" href="#4-2-10-3-scripting-javascript-jquery-and-prototype"><span class="fa fa-link"></span></a>4.2.10.3. Scripting: JavaScript, jQuery and Prototype</h4><p>All the JavaScript files are inside <code>webapp/javascripts</code> folder. We&apos;ve already mentioned a list of 3rd party libraries that we are using. There is an application level file called <code>application.js</code> inside <code>webapp/javascripts</code>.</p><p>To import JavaScript files you will need to define them in <code>_head.html.erb</code>. It has a flag inside called <code>use_compressed_js</code> which will decide whether it should merge all the file into <code>all.js</code> or not, the individual files listed after a tag <code>javascript_include_tag</code> is the sequence of how all the files will be included in the document.</p><p>All the JS files will be merged into a single file called <code>all.js</code> and will be placed inside <code>compressed</code> folder whenever we create a package along with <code>d3.js</code>. Browsers without SVG support will not be served file <code>d3.js</code>, we are keeping it isolated, especially for IE8.</p><h3 id="4-2-11-apis-cctray-feeds"><a name="4-2-11-apis-cctray-feeds" class="plugin-anchor" href="#4-2-11-apis-cctray-feeds"><span class="fa fa-link"></span></a>4.2.11 APIs, CCTray &amp; Feeds</h3><p><strong>WIP</strong></p></section></div></div></div><a href="../4/4.1.html" class="navigation navigation-prev" aria-label="Previous page: Overview"><i class="fa fa-angle-left"></i></a> <a href="../4/4.3.html" class="navigation navigation-next" aria-label="Next page: Go Agent"><i class="fa fa-angle-right"></i></a></div></div><script src="../gitbook/app.js"></script><script src="../gitbook/plugins/gitbook-plugin-ga/plugin.js"></script><script>require(["gitbook"],function(t){var n={fontSettings:{theme:null,family:"sans",size:2},ga:{token:"UA-48357651-1",configuration:"auto"}};t.start(n)});</script><script>!function(e,a,t,n,c,o,s){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,o=a.createElement(t),s=a.getElementsByTagName(t)[0],o.async=1,o.src=n,s.parentNode.insertBefore(o,s)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-48357651-1","auto"),ga("send","pageview");</script></body></html>